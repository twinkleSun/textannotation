<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.annotation.dao.DocumentMapper">
  <!--<resultMap id="BaseResultMap" type="com.annotation.model.File">-->
    <!--&lt;!&ndash;-->
      <!--WARNING - @mbg.generated-->
      <!--This element is automatically generated by MyBatis Generator, do not modify.-->
    <!--&ndash;&gt;-->
    <!--<id column="id" jdbcType="INTEGER" property="id" />-->
    <!--<result column="filename" jdbcType="VARCHAR" property="filename" />-->
    <!--<result column="content" jdbcType="VARCHAR" property="content" />-->
    <!--<result column="type" jdbcType="VARCHAR" property="type" />-->
    <!--<result column="size" jdbcType="VARCHAR" property="size" />-->
    <!--<result column="relativepath" jdbcType="VARCHAR" property="relativepath" />-->
    <!--<result column="absolutepath" jdbcType="VARCHAR" property="absolutepath" />-->
    <!--<result column="uploadtime" jdbcType="TIMESTAMP" property="uploadtime" />-->
  <!--</resultMap>-->
  <!--<delete id="deleteByPrimaryKey" parameterType="java.lang.Integer">-->
    <!--&lt;!&ndash;-->
      <!--WARNING - @mbg.generated-->
      <!--This element is automatically generated by MyBatis Generator, do not modify.-->
    <!--&ndash;&gt;-->
    <!--delete from file-->
    <!--where id = #{id,jdbcType=INTEGER}-->
  <!--</delete>-->

  <!--<update id="updateByPrimaryKey" parameterType="com.annotation.model.File">-->
    <!--&lt;!&ndash;-->
      <!--WARNING - @mbg.generated-->
      <!--This element is automatically generated by MyBatis Generator, do not modify.-->
    <!--&ndash;&gt;-->
    <!--update file-->
    <!--set filename = #{filename,jdbcType=VARCHAR},-->
      <!--content = #{content,jdbcType=VARCHAR},-->
      <!--`type` = #{type,jdbcType=VARCHAR},-->
      <!--`size` = #{size,jdbcType=VARCHAR},-->
      <!--relativepath = #{relativepath,jdbcType=VARCHAR},-->
      <!--absolutepath = #{absolutepath,jdbcType=VARCHAR},-->
      <!--uploadtime = #{uploadtime,jdbcType=TIMESTAMP}-->
    <!--where id = #{id,jdbcType=INTEGER}-->
  <!--</update>-->
  <!--<select id="selectByPrimaryKey" parameterType="java.lang.Integer" resultMap="BaseResultMap">-->
    <!--&lt;!&ndash;-->
      <!--WARNING - @mbg.generated-->
      <!--This element is automatically generated by MyBatis Generator, do not modify.-->
    <!--&ndash;&gt;-->
    <!--select id, filename, content, `type`, `size`, relativepath, absolutepath, uploadtime-->
    <!--from file-->
    <!--where id = #{id,jdbcType=INTEGER}-->
  <!--</select>-->
  <!--<select id="selectAll" resultMap="BaseResultMap">-->
    <!--&lt;!&ndash;-->
      <!--WARNING - @mbg.generated-->
      <!--This element is automatically generated by MyBatis Generator, do not modify.-->
    <!--&ndash;&gt;-->
    <!--select id, filename, content, `type`, `size`, relativepath, absolutepath, uploadtime-->
    <!--from file-->
  <!--</select>-->

  <insert id="insertDocument" useGeneratedKeys="true" keyProperty="did" parameterType="com.annotation.model.Document">
    insert into document
    (filename, filetype, filesize,relativepath, absolutepath, docuploadtime,doccomptime,docstatus,userid)
    values
    (#{filename}, #{filetype}, #{filesize},#{relativepath}, #{absolutepath}, #{docuploadtime}, #{doccomptime},#{docstatus},#{userid})
  </insert>

  <select id="selectDocumentByRelatedInfo" parameterType="map" resultType="com.annotation.model.Document">
        select * from document where userid = #{userid} limit #{currIndex},#{pageSize}
    </select>

  <select id="countDocNumByUserId" parameterType="Integer" resultType="Integer">
    select count(*) from document where userid = #{userid}
  </select>

  <select id="selectDocumentByTaskid" parameterType="Integer" resultType="com.annotation.model.Document">
        SELECT d.did,d.filename,d.filetype,d.filesize FROM task t INNER JOIN task_document td ON t.tid=td.taskid
        INNER JOIN document d on td.documentid = d.did WHERE t.tid=#{taskid}
  </select>

  <select id="selectDocumentById" parameterType="Integer" resultType="com.annotation.model.Document" >
    select * from document where did = #{did}
  </select>


  <update id="updateDocumentById" parameterType="com.annotation.model.Document">
    UPDATE Document
    <trim prefix="set" suffixOverrides=",">
      <if test="filename!=null">filename=#{filename},</if>
      <if test="filetype!=null">filetype=#{filetype},</if>
      <if test="filesize!=null">filesize=#{filesize},</if>
      <if test="relativepath!=null">relativepath=#{relativepath},</if>
      <if test="absolutepath!=null">absolutepath=#{absolutepath},</if>
      <if test="docuploadtime!=null">docuploadtime=#{docuploadtime},</if>
      <if test="doccomptime!=null">doccomptime=#{doccomptime},</if>
      <if test="docstatus!=null">docstatus=#{docstatus},</if>
      <if test="userid!=null">userid=#{userid},</if>
    </trim>
    WHERE did = #{did}
  </update>



</mapper>