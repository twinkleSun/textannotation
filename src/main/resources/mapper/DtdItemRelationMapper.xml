<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.annotation.dao.DtdItemRelationMapper" >

  <resultMap id="BaseResultMap" type="com.annotation.model.DtdItemRelation" >
    <id column="dtd_itrid" property="dtdItrid" jdbcType="INTEGER" />
    <result column="dt_inst_id" property="dtInstId" jdbcType="INTEGER" />
    <result column="a_listitem_id" property="aListitemId" jdbcType="INTEGER" />
    <result column="b_listitem_id" property="bListitemId" jdbcType="INTEGER" />
  </resultMap>

  <delete id="deleteByPrimaryKey" parameterType="java.lang.Integer" >
    delete from dtd_item_relation
    where dtd_itrid = #{dtdItrid,jdbcType=INTEGER}
  </delete>

  <insert id="insert" useGeneratedKeys="true" keyProperty="dtdItrid" parameterType="com.annotation.model.DtdItemRelation" >
    insert into dtd_item_relation (dtd_itrid, dt_inst_id, a_listitem_id, 
      b_listitem_id)
    values (#{dtdItrid,jdbcType=INTEGER}, #{dtInstId,jdbcType=INTEGER}, #{aListitemId,jdbcType=INTEGER}, 
      #{bListitemId,jdbcType=INTEGER})
  </insert>

  <update id="updateByPrimaryKey" parameterType="com.annotation.model.DtdItemRelation" >
    update dtd_item_relation
    set dt_inst_id = #{dtInstId,jdbcType=INTEGER},
      a_listitem_id = #{aListitemId,jdbcType=INTEGER},
      b_listitem_id = #{bListitemId,jdbcType=INTEGER}
    where dtd_itrid = #{dtdItrid,jdbcType=INTEGER}
  </update>

  <select id="selectByPrimaryKey" resultMap="BaseResultMap" parameterType="java.lang.Integer" >
    select dtd_itrid, dt_inst_id, a_listitem_id, b_listitem_id
    from dtd_item_relation
    where dtd_itrid = #{dtdItrid,jdbcType=INTEGER}
  </select>

  <select id="selectAll" resultMap="BaseResultMap" >
    select dtd_itrid, dt_inst_id, a_listitem_id, b_listitem_id
    from dtd_item_relation
  </select>

  <select id="selectDtItemRelation" parameterType="Integer" resultMap="BaseResultMap">
    select * from dtd_item_relation where dt_inst_id = #{dtInstId} and a_listitem_id = #{aListItemId} and b_listitem_id = #{bListItemId}
  </select>



  <insert id="insertRelationListByOneToOne">
    insert into dtd_item_relation (dt_inst_id, a_listitem_id,b_listitem_id)
    SELECT #{dtInstId}, #{aListItemId}, #{bListItemId} FROM DUAL
    WHERE NOT EXISTS (SELECT dtd_itrid FROM dtd_item_relation WHERE dt_inst_id = #{dtInstId} and
    a_listitem_id = #{aListItemId} OR b_listitem_id = #{bListItemId})
  </insert>


  <insert id="insertRelationListByOneToMany">
    insert into dtd_item_relation (dt_inst_id, a_listitem_id,b_listitem_id)
    SELECT #{dtInstId}, #{aListItemId}, #{bListItemId} FROM DUAL
    WHERE NOT EXISTS (SELECT dtd_itrid FROM dtd_item_relation WHERE dt_inst_id = #{dtInstId} and
     b_listitem_id = #{bListItemId})
  </insert>

  <insert id="insertRelationListByManyToMany">
    insert into dtd_item_relation (dt_inst_id, a_listitem_id,b_listitem_id)
     values (#{dtInstId}, #{aListItemId},#{bListItemId})
  </insert>
</mapper>